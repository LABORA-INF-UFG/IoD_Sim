{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "configure",
      "type": "shell",
      "command": "./waf configure --enable-examples --enable-mpi --disable-python --enable-modules=drone",
      "options": {
        "cwd": "${workspaceFolder}/ns3/"
      },
      "group": "build",
      "problemMatcher": []
    },
    {
      "label": "build",
      "type": "shell",
      "command": "./waf build -j$(grep -c ^processor /proc/cpuinfo)",
      "options": {
        "cwd": "${workspaceFolder}/ns3/"
      },
      "group": "build",
      "problemMatcher": [
        "$gcc"
      ]
    },
    {
      "label": "run allen (droneclass)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-allen-droneclass --numDrones=1\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run davinci (droneclass)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-davinci-droneclass --config=${input:configFileDaVinciDroneclass}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "Cleanup results directory",
      "type": "shell",
      "command": "rm -rf ./results/*",
      "group": "none",
      "problemMatcher": []
    },
    {
      "label": "Cleanup Build",
      "type": "shell",
      "command": "./waf clean",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "none",
      "problemMatcher": []
    },
    {
      "label": "run IoD Sim",
      "type": "shell",
      "command": "./waf --run \"iod-sim --config=${input:configFileGeneralPurpose}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run allen",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-allen --numDrones=${input:numDrones}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run allen (hybrid LTE+WiFi)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-allen-hybrid-lte-wifi --numDrones=${input:numDrones}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run babbage",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-babbage --numDrones=${input:numDrones} --duration=${input:duration}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run babbage (hybrid LTE+WiFi)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-babbage-hybrid-lte-wifi --numDrones=${input:numDrones} --duration=${input:duration}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run davinci",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-davinci --config=${input:configFileDaVinci}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run davinci (hybrid LTE+WiFi)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-davinci-hybrid-lte-wifi --config=${input:configFileDaVinci}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run easley",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-easley --config=${input:configFileEasley}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run easley (hybrid LTE+WiFi)",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-easley-hybrid-lte-wifi --config=${input:configFileEasley}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run LTE LENA CostVelocity",
      "type": "shell",
      "command": "./waf --run \"lte-lena-costvelocity\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run LTE LENA Simple DaVinci",
      "type": "shell",
      "command": "./waf --run \"lte-lena-simple-davinci --config=${input:configFileLte}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run lte-scenario-basic",
      "type": "shell",
      "command": "./waf --run \"lte-scenario-basic --config=${input:configFileLteBasic}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run drone-scenario",
      "type": "shell",
      "command": "./waf --run \"drone-scenario --name=${input:nameDroneScenario} --config=./src/drone/config/${input:configFileDroneScenario}.json --radioMap=${input:radioMapDroneScenario}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run drone-scenario-noapp",
      "type": "shell",
      "command": "./waf --run \"drone-scenario-noapp --name=${input:nameDroneScenario} --config=./src/drone/config/${input:configFileDroneScenario}.json --radioMap=${input:radioMapDroneScenario}\"",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run debug",
      "type": "shell",
      "command": "./waf --run \"${input:scenario} ${input:opt_scenArgs}\" --gdb",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "run simulation with args",
      "type": "shell",
      "command": "./waf --run ${input:scenario} ${input:opt_args} --command-template=\"%s ${input:opt_scenArgs}\" ${input:opt_nextCmd}",
      "options": {
        "cwd": "${workspaceFolder}/ns3"
      },
      "group": "test"
    },
    {
      "label": "docs",
      "type": "shell",
      "command": "make html",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      },
      "windows": {
        "command": "./make.bat html",
        "options": {
          "cwd": "${workspaceFolder}/docs"
        }
      },
      "group": "build"
    },
    {
      "label": "docs (venv)",
      "type": "shell",
      "command": "make html",
      "options": {
        "cwd": "${workspaceFolder}/docs",
        "env": {
          "SPHINXBUILD": "${workspaceFolder}/venv/Scripts/sphinx-build"
        }
      },
      "windows": {
        "command": "./make.bat html",
        "options": {
          "cwd": "${workspaceFolder}/docs",
          "env": {
            "SPHINXBUILD": "${workspaceFolder}\\venv\\Scripts\\sphinx-build.exe"
          }
        }
      },
      "group": "build",
      "dependsOn": [
        "docs (venv) - clean"
      ]
    },
    {
      "label": "docs (venv) - clean",
      "type": "shell",
      "command": "make clean",
      "options": {
        "cwd": "${workspaceFolder}/docs",
        "env": {
          "SPHINXBUILD": "${workspaceFolder}/venv/Scripts/sphinx-build"
        }
      },
      "windows": {
        "command": "./make.bat clean",
        "options": {
          "cwd": "${workspaceFolder}/docs",
          "env": {
            "SPHINXBUILD": "${workspaceFolder}\\venv\\Scripts\\sphinx-build.exe"
          }
        }
      }
    },
    {
      "label": "docs (venv) - open",
      "type": "shell",
      "command": "xdg-open ./_build/html/index.html",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      },
      "windows": {
        "command": ".\\_build\\html\\index.html",
        "options": {
          "cwd": "${workspaceFolder}\\docs"
        }
      },
      "dependsOn": [
        "docs (venv)"
      ]
    }
  ],

  "inputs": [
    {
      "id": "numDrones",
      "type": "promptString",
      "description": "Number of drones to simulate",
      "default": "1"
    },
    {
      "id": "duration",
      "type": "promptString",
      "description": "Duration of this simulation, in seconds",
      "default": "10"
    },
    {
      "id": "scenario",
      "type": "promptString",
      "description": "Name of the scenario to run",
      "default": "test-scenario"
    },
    {
      "id": "opt_args",
      "type": "promptString",
      "description": "Optional arguments to pass to waf command",
      "default": "--cwd=../results/"
    },
    {
      "id": "opt_scenArgs",
      "type": "promptString",
      "description": "Optional arguments to pass to the scenario script",
      "default": "--config=../drone/config/test.json"
    },
    {
      "id": "opt_nextCmd",
      "type": "promptString",
      "description": "Optional next command (piping, output redirection, etc...)",
      "default": "> ../results/`date +%y%m%d-%H%M`.out 2>&1"
    },
    {
      "id": "configFileDaVinci",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/davinci.json"
    },
    {
      "id": "configFileDaVinciDroneclass",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/davinci-droneclass.json"
    },
    {
      "id": "configFileLte",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/lte-scenario.json"
    },
    {
      "id": "configFileEasley",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/easley.json"
    },
    {
      "id": "configFileGeneralPurpose",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/general_purpose_with_lte.json"
    },
    {
      "id": "configFileLteBasic",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/LTE-basic.json"
    },
    {
      "id": "configFileDroneScenario",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "proto"
    },
    {
      "id": "nameDroneScenario",
      "type": "promptString",
      "description": "Name of the scenario",
      "default": "DRONE_SCENARIO"
    },
    {
      "id": "radioMapDroneScenario",
      "type": "promptString",
      "description": "Generate the Radio Environment Map",
      "default": "false"
    },
    {
      "id": "configFileDebug",
      "type": "promptString",
      "description": "Path to configuration file for this scenario",
      "default": "./src/drone/config/proto.json"
    }
  ]
}
